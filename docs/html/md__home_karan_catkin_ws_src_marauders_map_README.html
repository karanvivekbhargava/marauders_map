<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Marauders Map: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Marauders Map
   </div>
   <div id="projectbrief">Indoor mapping using turtlebot</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__home_karan_catkin_ws_src_marauders_map_README.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 align="center">Marauders Map </h1>
<p><a href="https://travis-ci.org/karanvivekbhargava/marauders_map"></a> <a href="https://coveralls.io/github/karanvivekbhargava/marauders_map?branch=master"></a> <a href="https://opensource.org/licenses/MIT">Overview The Marauders Map product by Acme Robotics is one of its flagship products. It performs best for an indoor environment where you need to map an environment. It is a turtlebot package which utilizes rgbdslam_v2 ros package and an exploratory behaviour to map indoor environments to an octree format. License This project is under the MIT License</a>.</p>
<h2>SIP process</h2>
<p>Since this project was built alone, I have followed the solo iterative process (SIP).</p>
<p>Log details for the same can be found <a href="https://docs.google.com/spreadsheets/d/1UN-LUKyeZunZTpRnJA9aYaXh8SntVCdyPhzmPg2l0AY/edit#gid=0">here</a></p>
<p>Planning notes can be found <a href="https://docs.google.com/document/d/1BU2oDnlLBrMnNgZKm1wX3ZKhkwUWr54Su3-iXXmer3M/edit?usp=sharing">here</a></p>
<h2>Dependencies</h2>
<p>This project is dependent on:</p><ul>
<li>ROS Kinetic Kame</li>
<li>Turtlebot ROS packages</li>
<li><a href="https://github.com/felixendres/rgbdslam_v2">rgbdslam_v2</a> ROS package</li>
<li>Ubuntu 16.04</li>
<li>octovis <a href="used to view .ot files">OPTIONAL</a></li>
</ul>
<p>You may install rgbdslam_v2 from this <a href="https://github.com/felixendres/rgbdslam_v2">link</a>. However I've found some bugs in the code and have solved the same on my forked repository of rgbdslam_v2. I highly recommend to use the installation script given in this repository to install the same.</p>
<p>For ease of installation, I've modified the script from the main repository. This solves some of the commonly faced bugs during installation. To run the script follow the instructions below.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd &lt;path to repository&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;chmod +x install.sh</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;./install.sh</div></div><!-- fragment --><p>This should start installing rgbdslam and all its dependencies in a pain free manner. After it's installed you need to source as follows.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;source ~/Code/rgbdslam_catkin_ws/devel/setup.bash</div></div><!-- fragment --><p>Now you're all set to use rgbdslam with the turtlebot!</p>
<h2>How does this work?</h2>
<p>The activity diagram below contains a basic explanation of how the package is working. It has a node by the name <code><a class="el" href="class_path_planner.html" title="Class for PathPlanner. ">PathPlanner</a></code>. This node operates in the manner shown below. It keeps running and exploring the map using a simple algorithm till the user is satisfied with the map.</p>
<p>It uses the laserscan data to move around the environment. The robot goes straight till it encounters an obstacle which is nearer to it than a given threshold. The minimum distance from the laserscan data is published on the /minDistance topic. If there is an obstacle in the vicinity then the robot keeps turning till it finds a way to move forward again.</p>
<p>Once the user is satisfied with the map. They save the map using a service which is described below and kill the node. This is what is described in the activity diagram below.</p>
<p>&lt;img src = "UML/Final/explorer-activity_diagram.jpg" </p><blockquote class="doxtable">
<p></p>
<p></p>
</blockquote>
<h2>Build Instructions</h2>
<p>To build the ros node, follow the instructions given below.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mkdir -p ~/catkin_ws/src</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd ~/catkin_ws/</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;catkin_make</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;source devel/setup.bash</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;cd src/</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;git clone --recursive https://github.com/karanvivekbhargava/marauders_map.git</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;cd ..</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;catkin_make</div></div><!-- fragment --><h2>Running rostest</h2>
<p>The unit tests have been written using gtest and rostest. To run the tests, you need to be in the catkin workspace parent folder. Then run the commands below</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd &lt;path to catkin workspace&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;catkin_make run_tests</div></div><!-- fragment --><p> You can test using </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;rostest marauders_map pathPlannerTest.launch</div></div><!-- fragment --><h2>Run Steps</h2>
<p>To run the package with gazebo rendered custom world, you need to first build the project and then follow the instructions below.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;source ~/Code/rgbdslam_catkin_ws/devel/setup.bash</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd &lt;path to catkin workspace&gt;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;source devel/setup.bash</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;roslaunch marauders_map demo.launch</div></div><!-- fragment --><p>You will see several windows opening up. A new terminal will open up which will inform how the exploration package is moving. A new window for rgbdslam_v2 will open up and the gazebo environment will load up as well.</p>
<div class="image">
<img src="images/startScreen.jpg"  alt="alt text"/>
</div>
<p>When the gazebo world is loaded, the turtlebot will start to turn. It will drive forward until it encounters an obstacle, at which point it will stop, turn in place until it sees no obstacle, and then continue to drive forward. This is maybe considered a "dumb" way to navigate, but in the desired use cases, the area may be completely unknown and the robot's task is to collect as much information as it can about its surrounding environment.</p>
<h2>Saving the map</h2>
<p>Once you think you are satisfied with the map in the rgbdslam window after launching as instructed above, you have to run a service which will save the map.</p>
<p>Open a new terminal and source the rgbdslam as follows</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;source ~/Code/rgbdslam_catkin_ws/devel/setup.bash</div></div><!-- fragment --><p>Then we will call the rgbdslam service to save the octree map.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;rosservice call /rgbdslam/ros_ui_s save_octomap ~/savedEnvironment.ot</div></div><!-- fragment --><p>You can change the path of <code>~/savedEnvironment.ot</code> to any other filename or path that you'd like.</p>
<p>[NOTE : Do not call this service more than three times. I've encountered an issue for the same. If you do this for more times then rgbdslam gives a process died error and exits]</p>
<h2>Viewing the map [OPTIONAL]</h2>
<p>Since the output of the map is octree (.ot file), we can use the <a href="http://wiki.ros.org/octovis">octovis</a> package to view the output.</p>
<p>This can be installed by running the following command. However I haven't completely tested it without installing octomap and the likes.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo apt-get install ros-kinetic-octovis</div></div><!-- fragment --><p>You would have to run the following command to view the result</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;octovis ~/savedEnvironment.ot</div></div><!-- fragment --><p>Kindly change the path accordingly if you changed it in the previous step.</p>
<h2>Record rosbag</h2>
<p>To record rosbag you need to run the following</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;roslaunch marauders_map demo.launch record:=true</div></div><!-- fragment --><p>This will record a rosbag file into the results directory of this package.</p>
<p>[NOTE: This launch file will not record camera data, like RGB images and depth images, because the file size will become too large too quickly. If camera data is needed, rosbag will have to be run separately in another terminal.]</p>
<h2>Playback of rosbag</h2>
<p>To play the recorded data follow the instructions below after starting a roscore command in a new terminal.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd &lt;path to repository&gt;/results</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;rosbag play marauders_map.bag</div></div><!-- fragment --><p>[NOTE: Gazebo should not be running when playing back with rosbag.]</p>
<h2>Doxygen Documentation</h2>
<p>Although the repository contains the documentation, if you'd still like to generate it then follow the instructions below.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo apt-get install doxygen</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;sudo apt-get install doxywizard</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;doxywizard</div></div><!-- fragment --><p>Once doxywizard is open, select the workspace as the repository. Fill in the details as required and set the source code folder to the repository as well. Create a new folder in the repository and select that as the destination directory. Proceed with the default settings and generate the documentation. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
